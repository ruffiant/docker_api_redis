# Logstash 主配置文件

# 更新 HTTP 主机配置
api.http.host: "0.0.0.0"

# 设置 pipeline 缓冲区类型（显式设置以避免9.x版本的兼容性问题）
pipeline.buffer.type: "heap"

# 启用 X-Pack 监控（显式启用并配置重试机制）
xpack.monitoring.enabled: true
xpack.monitoring.elasticsearch.hosts: ["http://elasticsearch:9200"]
xpack.monitoring.elasticsearch.connection_timeout: 15s
xpack.monitoring.elasticsearch.retry.initial: 5s
xpack.monitoring.elasticsearch.retry.max: 60s

# 其他基本配置
path.data: /usr/share/logstash/data
path.logs: /usr/share/logstash/logs
pipeline.workers: 2
pipeline.batch.size: 125
pipeline.batch.delay: 50

input {
  # 这里可以添加具体的输入配置
  beats {
    port => 5044
  }
}

filter {
  # 这里可以添加具体的过滤规则
}

output {
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]
    index => "%{[@metadata][beat]}-%{[@metadata][version]}-%{+YYYY.MM.dd}"
    connection_timeout => 15
    retry_initial_interval => 5
    retry_max_interval => 60
  }
}